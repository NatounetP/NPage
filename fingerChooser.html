<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finger Chooser</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            height: 100vh;
            overflow: hidden;
        }
        
        /* Header - always clickable */
        .header {
            background: #0f3460;
            padding: 15px;
            text-align: center;
            border-bottom: 3px solid #e94560;
        }
        
        h1 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.8rem;
        }
        
        /* Mode selector */
        .mode-selector {
            display: flex;
            gap: 5px;
            margin: 0 auto 15px;
            max-width: 400px;
        }
        
        .mode-btn {
            flex: 1;
            padding: 10px;
            border: none;
            background: rgba(255,255,255,0.1);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .mode-btn.active {
            background: #e94560;
            color: white;
        }
        
        /* Settings */
        .settings {
            background: rgba(255,255,255,0.05);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }
        
        .settings.active {
            display: block;
        }
        
        .setting {
            color: white;
            margin-bottom: 8px;
        }
        
        /* Progress bar */
        .progress {
            width: 100%;
            height: 5px;
            background: rgba(255,255,255,0.1);
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: #00b894;
            transition: width 0.1s;
        }
        
        /* Status */
        .status {
            color: white;
            text-align: center;
            padding: 10px;
            font-size: 1rem;
        }
        
        /* Touch area - main screen */
        .touch-area {
            position: fixed;
            top: 180px; /* Below header */
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent;
        }
        
        /* Finger circles - BIG and CLEAR */
        .finger {
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 2rem;
            color: white;
            transform: translate(-50%, -50%);
            border: 4px solid white;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            z-index: 10;
        }
        
        /* Winner - VERY BIG */
        .finger.winner {
            width: 150px;
            height: 150px;
            font-size: 3rem;
            background: gold !important;
            border-color: gold;
            box-shadow: 0 0 50px gold;
            z-index: 100;
        }
        
        /* Teams - same colors */
        .team-1 { background: #FF5252; }
        .team-2 { background: #448AFF; }
        .team-3 { background: #64FFDA; }
        .team-4 { background: #FFD740; }
        .team-5 { background: #E040FB; }
        
        /* Ranking colors */
        .rank-1 { background: gold; }
        .rank-2 { background: silver; }
        .rank-3 { background: #cd7f32; }
        .rank-other { background: #667eea; }
        
        /* Result message */
        .result {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 1.5rem;
            text-align: center;
            display: none;
            z-index: 1000;
            border: 2px solid white;
        }
        
        .result.show {
            display: block;
        }
        
        /* Reset button */
        .reset-btn {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #e94560;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üëÜ Finger Chooser</h1>
        
        <div class="mode-selector">
            <button class="mode-btn active" data-mode="winner">üéØ Winner</button>
            <button class="mode-btn" data-mode="teams">üë• Teams</button>
            <button class="mode-btn" data-mode="ranking">üèÜ Ranking</button>
        </div>
        
        <div class="progress">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <div class="settings" id="teamsSettings">
            <div class="setting">
                Teams: <span id="teamCount">2</span>
                <input type="range" id="teamSlider" min="2" max="5" value="2" style="width: 100%">
            </div>
        </div>
        
        <div class="settings" id="rankingSettings">
            <div class="setting">
                <button class="mode-btn" data-style="numbers">Numbers</button>
                <button class="mode-btn active" data-style="medals">Medals</button>
            </div>
        </div>
    </div>
    
    <div class="status" id="status">
        Touch below with fingers and hold still...
    </div>
    
    <div class="touch-area" id="touchArea"></div>
    
    <div class="result" id="result"></div>
    
    <button class="reset-btn" onclick="resetAll()">Reset Game</button>

    <script>
        // Simple variables
        let fingers = [];
        let currentMode = 'winner';
        let teamCount = 2;
        let rankingStyle = 'medals';
        let timer = null;
        let progress = 0;
        
        // Setup
        setupButtons();
        setupTouch();
        
        function setupButtons() {
            // Mode buttons
            document.querySelectorAll('.mode-btn[data-mode]').forEach(btn => {
                btn.onclick = function() {
                    // Update active button
                    document.querySelectorAll('.mode-btn[data-mode]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Set mode
                    currentMode = this.dataset.mode;
                    
                    // Show/hide settings
                    document.getElementById('teamsSettings').classList.remove('active');
                    document.getElementById('rankingSettings').classList.remove('active');
                    
                    if (currentMode === 'teams') {
                        document.getElementById('teamsSettings').classList.add('active');
                    } else if (currentMode === 'ranking') {
                        document.getElementById('rankingSettings').classList.add('active');
                    }
                    
                    updateStatus();
                };
            });
            
            // Ranking style buttons
            document.querySelectorAll('.mode-btn[data-style]').forEach(btn => {
                btn.onclick = function() {
                    document.querySelectorAll('.mode-btn[data-style]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    rankingStyle = this.dataset.style;
                };
            });
            
            // Team slider
            document.getElementById('teamSlider').oninput = function() {
                teamCount = this.value;
                document.getElementById('teamCount').textContent = teamCount;
            };
        }
        
        function setupTouch() {
            const touchArea = document.getElementById('touchArea');
            
            // Touch events
            touchArea.addEventListener('touchstart', handleTouch);
            touchArea.addEventListener('touchmove', handleTouch);
            touchArea.addEventListener('touchend', handleTouch);
            touchArea.addEventListener('touchcancel', handleTouch);
            
            // Mouse events for desktop
            touchArea.addEventListener('mousedown', function(e) {
                handleMouse(e, 'start');
            });
            touchArea.addEventListener('mousemove', function(e) {
                if (e.buttons === 1) { // Left button pressed
                    handleMouse(e, 'move');
                }
            });
            touchArea.addEventListener('mouseup', function(e) {
                handleMouse(e, 'end');
            });
            
            // Prevent context menu
            touchArea.addEventListener('contextmenu', e => e.preventDefault());
        }
        
        function handleTouch(e) {
            e.preventDefault();
            
            // Get current touches
            const touches = Array.from(e.touches);
            const touchIds = touches.map(t => t.identifier);
            
            // Remove fingers that are no longer touching
            fingers = fingers.filter(finger => {
                if (touchIds.includes(finger.id)) {
                    return true;
                } else {
                    finger.element.remove();
                    return false;
                }
            });
            
            // Update or create fingers
            touches.forEach(touch => {
                const existing = fingers.find(f => f.id === touch.identifier);
                if (existing) {
                    // Update position
                    existing.x = touch.clientX;
                    existing.y = touch.clientY;
                    existing.element.style.left = touch.clientX + 'px';
                    existing.element.style.top = touch.clientY + 'px';
                } else {
                    // Create new finger
                    createFinger(touch.identifier, touch.clientX, touch.clientY);
                }
            });
            
            checkStability();
            updateStatus();
        }
        
        function handleMouse(e, type) {
            const mouseId = 'mouse';
            
            if (type === 'start') {
                createFinger(mouseId, e.clientX, e.clientY);
                checkStability();
            } else if (type === 'move') {
                const finger = fingers.find(f => f.id === mouseId);
                if (finger) {
                    finger.x = e.clientX;
                    finger.y = e.clientY;
                    finger.element.style.left = e.clientX + 'px';
                    finger.element.style.top = e.clientY + 'px';
                    checkStability();
                }
            } else if (type === 'end') {
                fingers = fingers.filter(f => {
                    if (f.id === mouseId) {
                        f.element.remove();
                        return false;
                    }
                    return true;
                });
                stopTimer();
                updateStatus();
            }
        }
        
        function createFinger(id, x, y) {
            const fingerDiv = document.createElement('div');
            fingerDiv.className = 'finger';
            fingerDiv.textContent = (fingers.length + 1).toString();
            fingerDiv.style.left = x + 'px';
            fingerDiv.style.top = y + 'px';
            
            // Random color for new finger
            const colors = ['#FF5252', '#448AFF', '#64FFDA', '#FFD740', '#E040FB', '#667eea', '#764ba2'];
            fingerDiv.style.background = colors[fingers.length % colors.length];
            
            document.getElementById('touchArea').appendChild(fingerDiv);
            
            fingers.push({
                id: id,
                x: x,
                y: y,
                element: fingerDiv,
                number: fingers.length + 1
            });
        }
        
        function checkStability() {
            if (fingers.length >= 2) {
                // Start or continue timer
                if (!timer) {
                    startTimer();
                }
            } else {
                // Not enough fingers
                stopTimer();
            }
        }
        
        function startTimer() {
            if (timer) return;
            
            progress = 0;
            updateProgress();
            
            timer = setInterval(() => {
                progress += 100/30; // 3 seconds total
                updateProgress();
                
                if (progress >= 100) {
                    stopTimer();
                    runMode();
                }
            }, 100);
        }
        
        function stopTimer() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            progress = 0;
            updateProgress();
        }
        
        function updateProgress() {
            document.getElementById('progressBar').style.width = progress + '%';
        }
        
        function updateStatus() {
            const status = document.getElementById('status');
            
            if (fingers.length === 0) {
                status.textContent = 'Touch below with fingers and hold still...';
            } else if (fingers.length === 1) {
                status.textContent = 'Add more fingers (need at least 2)';
            } else if (timer) {
                const secondsLeft = Math.ceil((100 - progress) / (100/3));
                status.textContent = `${fingers.length} fingers - ${secondsLeft}s...`;
            } else {
                status.textContent = `${fingers.length} fingers - Hold still!`;
            }
        }
        
        function runMode() {
            if (fingers.length === 0) return;
            
            switch(currentMode) {
                case 'winner':
                    selectWinner();
                    break;
                case 'teams':
                    createTeams();
                    break;
                case 'ranking':
                    createRanking();
                    break;
            }
        }
        
        function selectWinner() {
            const winnerIndex = Math.floor(Math.random() * fingers.length);
            const winner = fingers[winnerIndex];
            
            // Make winner BIG and gold
            fingers.forEach((finger, index) => {
                if (index === winnerIndex) {
                    finger.element.classList.add('winner');
                    finger.element.textContent = 'üëë';
                } else {
                    // Fade others
                    finger.element.style.opacity = '0.3';
                }
            });
            
            showResult(`Winner: Finger #${winner.number}!`);
            setTimeout(resetAll, 3000);
        }
        
        function createTeams() {
            // Shuffle fingers
            const shuffled = [...fingers].sort(() => Math.random() - 0.5);
            
            // Distribute into teams
            const teams = [];
            for (let i = 0; i < teamCount; i++) {
                teams.push([]);
            }
            
            shuffled.forEach((finger, index) => {
                const teamIndex = index % teamCount;
                teams[teamIndex].push(finger);
                
                // Apply team color and number
                finger.element.classList.add('team-' + (teamIndex + 1));
                finger.element.textContent = 'T' + (teamIndex + 1);
            });
            
            // Show result
            let resultText = `${teamCount} Teams Created\n`;
            teams.forEach((team, index) => {
                resultText += `Team ${index + 1}: ${team.length} player${team.length !== 1 ? 's' : ''}\n`;
            });
            showResult(resultText);
            
            setTimeout(resetAll, 3000);
        }
        
        function createRanking() {
            // Shuffle for random ranking
            const shuffled = [...fingers].sort(() => Math.random() - 0.5);
            
            shuffled.forEach((finger, index) => {
                // Remove any existing classes
                finger.element.className = 'finger';
                
                // Add rank class
                if (index === 0) {
                    finger.element.classList.add('rank-1');
                    finger.element.textContent = rankingStyle === 'medals' ? 'ü•á' : '1';
                } else if (index === 1) {
                    finger.element.classList.add('rank-2');
                    finger.element.textContent = rankingStyle === 'medals' ? 'ü•à' : '2';
                } else if (index === 2) {
                    finger.element.classList.add('rank-3');
                    finger.element.textContent = rankingStyle === 'medals' ? 'ü•â' : '3';
                } else {
                    finger.element.classList.add('rank-other');
                    finger.element.textContent = (index + 1).toString();
                }
            });
            
            showResult('Ranking Created!');
        }
        
        function showResult(text) {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = text;
            resultDiv.classList.add('show');
            
            setTimeout(() => {
                resultDiv.classList.remove('show');
            }, 2000);
        }
        
        function resetAll() {
            // Remove all fingers
            fingers.forEach(finger => {
                finger.element.remove();
            });
            fingers = [];
            
            // Reset UI
            stopTimer();
            updateStatus();
            document.getElementById('result').classList.remove('show');
        }
    </script>
</body>
</html>